<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>MagniV API: Serial Peripheral interface</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MagniV API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Serial Peripheral interface</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:spi_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spi_8c.html">spi.c</a></td></tr>
<tr class="memdesc:spi_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains serial peripheral interface API routines for MagniV devices. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:spi_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="spi_8h.html">spi.h</a></td></tr>
<tr class="memdesc:spi_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains Serial peripheral interface API routines for MagniV devices. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structspi__divider.html">spi_divider</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A structure that holds the prescaler values for the baudrate configuration.  <a href="structspi__divider.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">union &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unionu_s_p_i_c_r1.html">uSPICR1</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">SPI Control Register 1.  <a href="unionu_s_p_i_c_r1.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">union &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unionu_s_p_i_c_r2.html">uSPICR2</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">SPI Control Register 2.  <a href="unionu_s_p_i_c_r2.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">union &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unionu_s_p_i_b_r.html">uSPIBR</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">SPI Baud Rate Register.  <a href="unionu_s_p_i_b_r.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">union &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unionu_s_p_i_s_r.html">uSPISR</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">SPI Status Register.  <a href="unionu_s_p_i_s_r.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">union &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unionu_s_p_i_d_r.html">uSPIDR</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">SPI Data Register.  <a href="unionu_s_p_i_d_r.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structt_s_p_i.html">tSPI</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">spi datastructure  <a href="structt_s_p_i.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gad368b88fcb5547c245121a4533e9f858"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gad368b88fcb5547c245121a4533e9f858"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>BIT_8</b>&#160;&#160;&#160;0</td></tr>
<tr class="separator:gad368b88fcb5547c245121a4533e9f858"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa5b535cdb2b0b6509a32f8a02ef64719"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaa5b535cdb2b0b6509a32f8a02ef64719"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>BIT_16</b>&#160;&#160;&#160;1</td></tr>
<tr class="separator:gaa5b535cdb2b0b6509a32f8a02ef64719"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac9d0bde2b42b2403d00b7a611514b006"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gac9d0bde2b42b2403d00b7a611514b006"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SPI_MODE0</b>&#160;&#160;&#160;0</td></tr>
<tr class="separator:gac9d0bde2b42b2403d00b7a611514b006"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9481b7327b91aa52ff5f70eb2d0acc95"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga9481b7327b91aa52ff5f70eb2d0acc95"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SPI_MODE1</b>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ga9481b7327b91aa52ff5f70eb2d0acc95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga991dec04d2fb38979cfb0d9fc7f8b026"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga991dec04d2fb38979cfb0d9fc7f8b026"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SPI_MODE2</b>&#160;&#160;&#160;2</td></tr>
<tr class="separator:ga991dec04d2fb38979cfb0d9fc7f8b026"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5f928a2445070981765ee0416c12369d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga5f928a2445070981765ee0416c12369d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SPI_MODE3</b>&#160;&#160;&#160;3</td></tr>
<tr class="separator:ga5f928a2445070981765ee0416c12369d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga9439139bf71e66bf6c7d3ee62fbd8bb4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga9439139bf71e66bf6c7d3ee62fbd8bb4"></a>
typedef union <a class="el" href="unionu_s_p_i_c_r1.html">uSPICR1</a>&#160;</td><td class="memItemRight" valign="bottom"><b>tSPICR1</b></td></tr>
<tr class="separator:ga9439139bf71e66bf6c7d3ee62fbd8bb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7699893f3d74243f57e751dfbfacd1ad"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga7699893f3d74243f57e751dfbfacd1ad"></a>
typedef union <a class="el" href="unionu_s_p_i_c_r2.html">uSPICR2</a>&#160;</td><td class="memItemRight" valign="bottom"><b>tSPICR2</b></td></tr>
<tr class="separator:ga7699893f3d74243f57e751dfbfacd1ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga52c014267ca69adfcf32dfe190b387fa"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga52c014267ca69adfcf32dfe190b387fa"></a>
typedef union <a class="el" href="unionu_s_p_i_b_r.html">uSPIBR</a>&#160;</td><td class="memItemRight" valign="bottom"><b>tSPIBR</b></td></tr>
<tr class="separator:ga52c014267ca69adfcf32dfe190b387fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1f010608bebe23084eee1e4e2b52fcba"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga1f010608bebe23084eee1e4e2b52fcba"></a>
typedef union <a class="el" href="unionu_s_p_i_s_r.html">uSPISR</a>&#160;</td><td class="memItemRight" valign="bottom"><b>tSPISR</b></td></tr>
<tr class="separator:ga1f010608bebe23084eee1e4e2b52fcba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga611171d26aac87ea183224ebbc723a65"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga611171d26aac87ea183224ebbc723a65"></a>
typedef union <a class="el" href="unionu_s_p_i_d_r.html">uSPIDR</a>&#160;</td><td class="memItemRight" valign="bottom"><b>tSPIDR</b></td></tr>
<tr class="separator:ga611171d26aac87ea183224ebbc723a65"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gab49ca6ed7d4337f79a4a46253a0bcc62"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_p_i.html#gab49ca6ed7d4337f79a4a46253a0bcc62">spi_init_mst</a> (unsigned long BusClock, unsigned long baudrate, unsigned char transfer_width, unsigned char SPI_MODE)</td></tr>
<tr class="memdesc:gab49ca6ed7d4337f79a4a46253a0bcc62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the SPI interface to the desired baudrate as a Master.  <a href="#gab49ca6ed7d4337f79a4a46253a0bcc62">More...</a><br /></td></tr>
<tr class="separator:gab49ca6ed7d4337f79a4a46253a0bcc62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga65cea3c951df80d515ad8de782eacdb8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_p_i.html#ga65cea3c951df80d515ad8de782eacdb8">spi_init_slv</a> (unsigned char transfer_width, unsigned char SPI_MODE)</td></tr>
<tr class="memdesc:ga65cea3c951df80d515ad8de782eacdb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the SPI interface as slave.  <a href="#ga65cea3c951df80d515ad8de782eacdb8">More...</a><br /></td></tr>
<tr class="separator:ga65cea3c951df80d515ad8de782eacdb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1891ee7d4d812f998f290c9a1a65068b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structspi__divider.html">spi_divider</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_p_i.html#ga1891ee7d4d812f998f290c9a1a65068b">spi_baud_cal</a> (unsigned long BusClock, unsigned long baudrate)</td></tr>
<tr class="memdesc:ga1891ee7d4d812f998f290c9a1a65068b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the best dividers values for the desired frequency.  <a href="#ga1891ee7d4d812f998f290c9a1a65068b">More...</a><br /></td></tr>
<tr class="separator:ga1891ee7d4d812f998f290c9a1a65068b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0ae24835498fe160774990423328cc41"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_p_i.html#ga0ae24835498fe160774990423328cc41">send_SPI</a> (word data)</td></tr>
<tr class="memdesc:ga0ae24835498fe160774990423328cc41"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends data through SPI.  <a href="#ga0ae24835498fe160774990423328cc41">More...</a><br /></td></tr>
<tr class="separator:ga0ae24835498fe160774990423328cc41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga47ab469f1d05e31eab7814cab5123127"><td class="memItemLeft" align="right" valign="top">word&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_p_i.html#ga47ab469f1d05e31eab7814cab5123127">get_SPI</a> (void)</td></tr>
<tr class="memdesc:ga47ab469f1d05e31eab7814cab5123127"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receives data through SPI.  <a href="#ga47ab469f1d05e31eab7814cab5123127">More...</a><br /></td></tr>
<tr class="separator:ga47ab469f1d05e31eab7814cab5123127"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0161f7f2a3f5e77e2e71051bdfdcb856"><td class="memItemLeft" align="right" valign="top">word&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___s_p_i.html#ga0161f7f2a3f5e77e2e71051bdfdcb856">tranfer_SPI</a> (word data)</td></tr>
<tr class="memdesc:ga0161f7f2a3f5e77e2e71051bdfdcb856"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends and receives data through the SPI interface.  <a href="#ga0161f7f2a3f5e77e2e71051bdfdcb856">More...</a><br /></td></tr>
<tr class="separator:ga0161f7f2a3f5e77e2e71051bdfdcb856"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga47ab469f1d05e31eab7814cab5123127"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">word get_SPI </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receives data through SPI. </p>
<dl class="section return"><dt>Returns</dt><dd>Data received through SPI </dd></dl>

</div>
</div>
<a class="anchor" id="ga0ae24835498fe160774990423328cc41"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void send_SPI </td>
          <td>(</td>
          <td class="paramtype">word&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends data through SPI. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>Data to be sent </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga1891ee7d4d812f998f290c9a1a65068b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structspi__divider.html">spi_divider</a> spi_baud_cal </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>BusClock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>baudrate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the best dividers values for the desired frequency. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">BusClock</td><td>Bus frequency of the device </td></tr>
    <tr><td class="paramname">baudrate</td><td>Desired baudrate</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Prescaler values that best match the desired baudrate, and the calculated error with these values </dd></dl>

</div>
</div>
<a class="anchor" id="gab49ca6ed7d4337f79a4a46253a0bcc62"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spi_init_mst </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>BusClock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>baudrate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>transfer_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>SPI_MODE</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the SPI interface to the desired baudrate as a Master. </p>
<p>This functions initializes the SPI interface to act as a master device, it sets the frequency of the SPI clock to the best possible match. It allows to select between 8-bit transfers or 16-bit transfers by passing the macro BIT_8 or BIT_16 respectively. The SPI_MODE parameter selects the Clock Polarity and Clock Phase for the communication protocol. In order for an SPI transaction to occur successfully both master and slave must have the same Clock Polarity and Clock phase configuration. The Clock Polarity and Clock Phase configuration can be achieved as follows </p><table  border="1">
<tr>
<td>SPI_MODE </td><td>Clock Phase </td><td>Clock Polarity  </td></tr>
<tr>
<td>SPI_MODE0 </td><td>0 </td><td>0  </td></tr>
<tr>
<td>SPI_MODE1 </td><td>0 </td><td>1  </td></tr>
<tr>
<td>SPI_MODE2 </td><td>1 </td><td>0  </td></tr>
<tr>
<td>SPI_MODE3 </td><td>1 </td><td>1  </td></tr>
</table>
<p>By setting the Clock Polarity to zero active-high clocks are selected. In idle state SCK is low.</p>
<p>By setting the Clock Polarity to one active-low clocks selected. In idle state SCK is high.</p>
<p>By setting the Clock Phase to zero sampling of data occurs at odd edges (1,3,5,...) of the SCK clock.</p>
<p>By setting the Clock Phase to one sampling of data occurs at even edges (2,4,6,...) of the SCK clock.</p>
<p>For more information refer to the Reference Manual of your device. The following example sets the SPI clock to a frequency of 12.5MHz with a Bus frequency of 25MHz, selecting an 8-Bit transfer, Clock Polarity with active-high clocks and clock phase with sampling of data at odd edges: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;spi_init_mst(25000000, 12500000, BIT_8, SPI_MODE0);</div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">BusClock</td><td>Bus frequency of the device </td></tr>
    <tr><td class="paramname">baudrate</td><td>Desired baudrate </td></tr>
    <tr><td class="paramname">transfer_width</td><td>Select between 8bit transfer and 16bit transfer </td></tr>
    <tr><td class="paramname">SPI_MODE</td><td>Selects the Clock polarity and Clock phase </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga65cea3c951df80d515ad8de782eacdb8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spi_init_slv </td>
          <td>(</td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>transfer_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>SPI_MODE</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the SPI interface as slave. </p>
<p>This functions initializes the SPI interface to act as a slave device. It allows to select between 8-bit transfers or 16-bit transfers by passing the macro BIT_8 or BIT_16 respectively. The SPI_MODE parameter selects the Clock Polarity and Clock Phase for the communication protocol. In order for an SPI transaction to occur successfully both master and slave must have the same Clock Polarity and Clock phase configuration. The Clock Polarity and Clock Phase configuration can be achieved as follows </p><table  border="1">
<tr>
<td>SPI_MODE </td><td>Clock Phase </td><td>Clock Polarity  </td></tr>
<tr>
<td>SPI_MODE0 </td><td>0 </td><td>0  </td></tr>
<tr>
<td>SPI_MODE1 </td><td>0 </td><td>1  </td></tr>
<tr>
<td>SPI_MODE2 </td><td>1 </td><td>0  </td></tr>
<tr>
<td>SPI_MODE3 </td><td>1 </td><td>1  </td></tr>
</table>
<p>By setting the Clock Polarity to zero active-high clocks are selected. In idle state SCK is low.</p>
<p>By setting the Clock Polarity to one active-low clocks selected. In idle state SCK is high.</p>
<p>By setting the Clock Phase to zero sampling of data occurs at odd edges (1,3,5,...) of the SCK clock.</p>
<p>By setting the Clock Phase to one sampling of data occurs at even edges (2,4,6,...) of the SCK clock.</p>
<p>For more information refer to the Reference Manual of your device. The following example selects an 8-Bit transfer, Clock Polarity with active-high clocks and clock phase with sampling of data at odd edges: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;spi_init_slv(BIT_8, SPI_MODE0);</div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">transfer_width</td><td>Select between 8bit transfer and 16bit transfer </td></tr>
    <tr><td class="paramname">SPI_MODE</td><td>Selects the Clock polarity and Clock phase </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga0161f7f2a3f5e77e2e71051bdfdcb856"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">word tranfer_SPI </td>
          <td>(</td>
          <td class="paramtype">word&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends and receives data through the SPI interface. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>Data to be send through the SPI interface</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Data received through the SPI interface </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
